use std

use "dfa.use"
use "lalr.use"
use "nfa.use"
use "parse.use"
use "types.use"
use "write.use"

const main = {args
	var tab, dfa, nfa
	var parsed
	var rules

	parsed = std.optparse(args, &[
		.argdesc="inputs...", 
		.minargs=1
	])
	for f in parsed.args
		rules = pg.parse(f)
		nfa = pg.mknfa(rules)
		dfa = pg.mkdfa(nfa)
		tab = pg.genlalrtab(rules)
		pg.write(tab)
	;;
}

